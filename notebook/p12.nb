(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     11395,        420]
NotebookOptionsPosition[      9246,        340]
NotebookOutlinePosition[      9620,        357]
CellTagsIndexPosition[      9577,        354]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Project Euler-",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ": Problem 12"
}], "Title"],

Cell["\<\
The sequence of triangle numbers is generated by adding the natural numbers. \
So the 7th triangle number would be 1 + 2 + 3 + 4 + 5 + 6 + 7 = 28. The first \
ten terms would be:

1, 3, 6, 10, 15, 21, 28, 36, 45, 55, ...

Let us list the factors of the first seven triangle numbers:

 1: 1
 3: 1,3
 6: 1,2,3,6
10: 1,2,5,10
15: 1,3,5,15
21: 1,3,7,21
28: 1,2,4,7,14,28
We can see that 28 is the first triangle number to have over five divisors.

What is the value of the first triangle number to have over five hundred \
divisors?\
\>", "Text"],

Cell[CellGroupData[{

Cell["\<\
Two ways of implementing a TriangularNumber[]\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcTriangularNumberDev1", "[", "n_", "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"Range", "[", "n", "]"}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcTiming", "[", 
  RowBox[{"mcTriangularNumberDev1", "[", "1000000", "]"}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(1\\) iterations for a total time of 0.00945 \
seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 1, "0.00945"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(10\\) iterations for a total time of 0.0633 \
seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 10, "0.0633"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(100\\) iterations for a total time of 0.604 \
seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 100, "0.604"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(1000\\) iterations for a total time of 6.10 \
seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 1000, "6.10"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"estimating based on \\!\\(10000\\) iterations run for \
a total time of 62.6 seconds\"\>",
  StringForm[
  "estimating based on `1` iterations run for a total time of `2` seconds", 
   10000, "62.6"],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00625670890000000028408067009877413511`7.816945862717011", ",", 
   "500000500000"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$TimeUnit"], "Input"],

Cell[BoxData[
 FractionBox["1", "100"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{"Timing", "[", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mcTriangularNumberDev1", "[", "1000000", "]"}], ";"}], ",", 
       RowBox[{"{", "1000", "}"}]}], "]"}], "]"}], "]"}], "/", "1000"}], "//",
   "N"}]], "Input"],

Cell[BoxData["0.006096249000000001`"], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "mcTriangularNumberDev2", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mcTriangularNumberDev2", "[", "1", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mcTriangularNumberDev2", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"mcTriangularNumberDev2", "[", "n", "]"}], "=", 
    RowBox[{
     RowBox[{"mcTriangularNumberDev2", "[", 
      RowBox[{"n", "-", "1"}], "]"}], "+", "n"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcTriangularNumberDev2", "[", "7", "]"}]], "Input"],

Cell[BoxData["28"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{"Timing", "[", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mcTriangularNumberDev2", "[", "1000000", "]"}], ";"}], ",", 
       RowBox[{"{", "1000000", "}"}]}], "]"}], "]"}], "]"}], "/", "1000000"}],
   "//", "N"}]], "Input"],

Cell[BoxData["3.59621`*^-7"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcTiming", "[", 
  RowBox[{"mcTriangularNumberDev2", "[", "1000000", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$RecursionLimit", "::", "reclim"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Recursion depth of \[NoBreak]\\!\\(1024\\)\[NoBreak] \
exceeded. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/$RecursionLimit/reclim\\\", ButtonNote -> \
\\\"$RecursionLimit::reclim\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(1\\) iterations for a total time of 3.69 \
seconds\"\>",
  StringForm["ran `1` iterations for a total time of `2` seconds", 1, "3.69"],
  
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(10\\) iterations for a total time of \
0.0000190 seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 10, "0.0000190"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(100\\) iterations for a total time of \
0.0000610 seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 100, "0.0000610"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(1000\\) iterations for a total time of \
0.000545 seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 1000, "0.000545"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"ran \\!\\(10000\\) iterations for a total time of \
0.00536 seconds\"\>",
  StringForm[
  "ran `1` iterations for a total time of `2` seconds", 10000, "0.00536"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox["\<\"estimating based on \\!\\(100000\\) iterations run \
for a total time of 0.0569 seconds\"\>",
  StringForm[
  "estimating based on `1` iterations run for a total time of `2` seconds", 
   100000, "0.0569"],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"mcTriangularNumberDev2", "[", "1000000", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcTriangularNumber", "=", "mcTriangularNumberDev2"}], 
  ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution 1", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"#", ",", "\[IndentingNewLine]", 
      RowBox[{"mcTriangularNumber", "[", "#", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", "=", 
          RowBox[{"mcTriangularNumber", "[", "#", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", "=", 
            RowBox[{"FactorInteger", "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", "1"}], 
             ")"}]}], "+", "1"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "&"}], "/@", 
   RowBox[{"Range", "[", "7", "]"}]}], "//", "Grid"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "1", "2"},
    {"2", "3", "2"},
    {"3", "6", "3"},
    {"4", "10", "3"},
    {"5", "15", "3"},
    {"6", "21", "3"},
    {"7", "28", "5"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Divisors", "[", 
       RowBox[{"res", "=", 
        RowBox[{"mcTriangularNumber", "[", "n", "]"}]}], "]"}], "]"}], 
     "\[LessEqual]", "500"}], ",", "\[IndentingNewLine]", 
    RowBox[{"n", "++"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", "n", "\[IndentingNewLine]", "res"}], "Input"],

Cell[BoxData["76576500"], "Output"],

Cell[BoxData["12375"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Divisors", "[", 
   RowBox[{"mcTriangularNumber", "[", 
    RowBox[{"12375", "-", "1"}], "]"}], "]"}], "//", "Length"}]], "Input"],

Cell[BoxData["96"], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 867},
WindowMargins->{{Automatic, 3}, {Automatic, 130}},
ShowSelection->True,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 112, 5, 148, "Title"],
Cell[694, 29, 552, 20, 334, "Text"],
Cell[CellGroupData[{
Cell[1271, 53, 75, 2, 44, "Subsection"],
Cell[1349, 57, 165, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[1539, 65, 116, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[1680, 71, 222, 5, 21, "Print"],
Cell[1905, 78, 222, 5, 21, "Print"],
Cell[2130, 85, 222, 5, 21, "Print"],
Cell[2355, 92, 222, 5, 21, "Print"],
Cell[2580, 99, 268, 6, 22, "Print"]
}, Open  ]],
Cell[2863, 108, 148, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3048, 117, 35, 0, 28, "Input"],
Cell[3086, 119, 50, 1, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3173, 125, 321, 10, 46, "Input"],
Cell[3497, 137, 48, 0, 28, "Output"]
}, Open  ]],
Cell[3560, 140, 501, 13, 80, "Input"],
Cell[CellGroupData[{
Cell[4086, 157, 75, 1, 28, "Input"],
Cell[4164, 160, 29, 0, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4230, 165, 327, 10, 46, "Input"],
Cell[4560, 177, 39, 0, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4636, 182, 116, 2, 28, "Input"],
Cell[4755, 186, 432, 9, 24, "Message"],
Cell[CellGroupData[{
Cell[5212, 199, 216, 5, 21, "Print"],
Cell[5431, 206, 228, 5, 21, "Print"],
Cell[5662, 213, 230, 5, 21, "Print"],
Cell[5895, 220, 230, 5, 21, "Print"],
Cell[6128, 227, 230, 5, 21, "Print"],
Cell[6361, 234, 274, 6, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[6662, 244, 81, 1, 28, "Input"],
Cell[6746, 247, 108, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6891, 255, 32, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[6948, 259, 1083, 29, 148, "Input"],
Cell[8034, 290, 307, 12, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8378, 307, 521, 13, 131, "Input"],
Cell[8902, 322, 35, 0, 28, "Output"],
Cell[8940, 324, 32, 0, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9009, 329, 165, 4, 28, "Input"],
Cell[9177, 335, 29, 0, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
